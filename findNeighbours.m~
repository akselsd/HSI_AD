function NN = findNeighbours(idx, h, M, win_i)
    
    i_tl = idx - (ceil(win_i/2))*(h + 1); % top left corner of window
    i_tr = idx + (floor(win_i/2) + 1)*(h - 1); % top right corner
    
    i_bl = idx + (floor(win_i/2) + 1)*(h - 1); % bottom left corner
    i_br = idx + (floor(win_i/2) + 1)*(h + 1); % bottom right corner
    
    n1 = M(i_tl:i_tr, :);
    n2 = M(i_bl:i_br, :);
    
    i_tl = i_tl + h;
    i_tr = i_tr + h;
    
    i_bl = i_bl - h;
    i_br = i_br - h;
    
    n3 = M(i_tl:h:i_bl, :);
    n4 = M(i_tr:h:i_br, :);
    
    NN = [n1; n2; n3; n4];
end